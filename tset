pipeline {
    agent any
    
    stages{
        stage("Git Checkout"){
            steps{
                git branch: 'main', credentialsId: 'e46bb6cc-6f09-4f00-a546-1c60f2920427', url: 'https://github.com/surya-devopsaws/index.git'
            }
        }


        

            stage('Deploy') {
                steps {
                    // Deploy your application using sshPublisher
                    sshPublisher(publishers: [sshPublisherDesc(
                        configName: 'mypeeps',
                        transfers: [sshTransfer(
                            cleanRemote: false,
                            excludes: '',
                            execCommand: '',
                            flatten: false,
                            makeEmptyDirs: false,
                            noDefaultExcludes: false,
                            patternSeparator: '[, ]+',
                            remoteDirectory: '/',
                            remoteDirectorySDF: false,
                            removePrefix: '',
                            sourceFiles: '*/**'
                        )],
                        usePromotionTimestamp: false,
                        useWorkspaceInPromotion: false,
                        verbose: false
                    )])
                }
            }
          
        stage('SendMail') {
            steps {
                // Send an email notification using emailext plugin
                emailext(
                    attachLog: true,
                    body: '''Hello Team,

I\'m writing to share the Development of Mypeppys  website\'s latest build result with you. Please take a moment to review the website by visiting https://mypeppys.com/

If you need more information about this build, you can download the build log file and review it.

If you encounter any issues, kindly report them by replying to this email, and our Server Team will be happy to assist you.''',
                    recipientProviders: [buildUser(), requestor(), developers()],
                    replyTo: 'xyz@gmail.com',
                    subject: '$DEFAULT_SUBJECT',
                    to: 'sivacandypeace@gmail.com'
                )
            }
        }
    }
}        
